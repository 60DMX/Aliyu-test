#       WELCOME TO SQUID 4.11
#       ----------------------------
#       Client Proxy
#       Rebuild by 2020/07/31 Kevin.Wang
#       This is the documentation for the Squid configuration file.
#       This documentation can also be found online at:
#               http://www.squid-cache.org/Doc/config/
#broken_vary_encoding allow apache
hosts_file /etc/hosts
logformat squid %{%Y-%m-%d %H:%M:%S +0800}tl %6tr %>a %Ss/%03Hs %<st %rm %ru %un %Sh/%<A %mt
#header_access Via deny all
#header_access X-Cache deny all
#ignore_expect_100 on
forwarded_for off
connect_timeout 5 minute 

acl SSL_ports port 443          # https
acl SSL_ports port 563          # snews
acl SSL_ports port 873          #
acl SSL_ports port 2195         #
acl SSL_ports port 5600         #
acl SSL_ports port 1443         #

acl SSL_ports port 443
acl Safe_ports port 80		# http
acl Safe_ports port 21		# ftp
acl Safe_ports port 443		# https
acl Safe_ports port 70		# gopher
acl Safe_ports port 210		# wais
acl Safe_ports port 1025-65535	# unregistered ports
acl Safe_ports port 280		# http-mgmt
acl Safe_ports port 488		# gss-http
acl Safe_ports port 591		# filemaker
acl Safe_ports port 777		# multiling http
acl Safe_ports port 8104	# multiling http
acl CONNECT method CONNECT
acl purge method PURGE
http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports
http_access allow localhost manager
http_access deny manager
http_access allow purge localhost
http_access deny purge
http_access allow localhost
http_access deny CONNECT !SSL_ports

acl URN proto URN
http_access deny URN
########STEP 1#########################
# Define allow IP here
#######################################
acl wish_temp_src src 10.0.3.100
acl wish_temp_src src 10.0.1.199
acl wish_temp_src src 10.0.1.42
http_access allow wish_temp_src all

#acl temp_src src 10.10.1.244
#acl temp_src src 10.10.1.245
#acl temp_src src 10.4.1.244
#http_access allow temp_src all


acl cola_erp_src src 10.1.1.81
acl cola_erp_dst dstdomain tscloud.digiwin.com
http_access allow cola_erp_src cola_erp_dst

#kevin_hackmd_tmp
acl kevin_hackmd_src src 10.0.1.237
http_access allow kevin_hackmd_src all

#yum_update
acl yum_update_src src 10.66.6.0/24
acl yum_update_src src 10.106.2.0/24
acl yum_update_src src 10.0.0.0/21
acl yum_update_src src 10.1.1.0/24
acl yum_update_src src 10.1.2.0/24
acl yum_update_src src 10.1.4.0/24
acl yum_update_src src 10.1.5.0/24
acl yum_update_src src 10.2.1.0/24
acl yum_update_src src 10.4.1.0/24
acl yum_update_dst dstdomain api.rubygems.org
acl yum_update_dst dstdomain ftp.isu.edu.tw
acl yum_update_dst dstdomain centos.cs.nctu.edu.tw
acl yum_update_dst dstdomain ftp.ksu.edu.tw
acl yum_update_dst dstdomain mirror01.idc.hinet.net
acl yum_update_dst dstdomain free.nchc.org.tw
acl yum_update_dst dstdomain .pythonhosted.org
acl yum_update_dst dstdomain pypi.org
acl yum_update_dst dstdomain pypi.python.org
acl yum_update_dst dstdomain .digicert.com
acl yum_update_dst dstdomain login.live.com
acl yum_update_dst dstdomain .msftconnecttest.com
acl yum_update_dst dstdomain mirror.dmmlabs.jp
acl yum_update_dst dstdomain mirrors.nipa.cloud
acl yum_update_dst dstdomain mirrors.tuna.tsinghua.edu.cn
acl yum_update_dst dstdomain ftp.jaist.ac.jp
acl yum_update_dst dstdomain mirror2.totbb.net
acl yum_update_dst dstdomain mirrors.tongji.edu.cn
acl yum_update_dst dstdomain mirrors.ustc.edu.cn
acl yum_update_dst dstdomain epel.mirror.angkasa.id
acl yum_update_dst dstdomain del-mirrors.extreme-ix.org
acl yum_update_dst dstdomain mirror.nes.co.id
acl yum_update_dst dstdomain ftp.kddilabs.jp
acl yum_update_dst dstdomain epel.scopesky.iq
acl yum_update_dst dstdomain kartolo.sby.datautama.net.id
acl yum_update_dst dstdomain mirror.pregi.net
acl yum_update_dst dstdomain mirror.ehost.vn
acl yum_update_dst dstdomain mirror.rise.ph
acl yum_update_dst dstdomain www.python.org
acl yum_update_dst dstdomain yum.puppetlabs.com
acl yum_update_dst dstdomain www.elrepo.org
acl yum_update_dst dstdomain yum.puppetlabs.com/el/6/PC1/x86_64/repodata/repomd.xml
acl yum_update_dst dstdomain cdn.remirepo.net
acl yum_update_dst dstdomain rpms.famillecollet.com
acl yum_update_dst dstdomain dl.fedoraproject.org
acl yum_update_dst dstdomain rpms.remirepo.net
acl yum_update_dst dstdomain download.owncloud.org
acl yum_update_dst dstdomain mirrors.fedoraproject.org
acl yum_update_dst dstdomain yum.mariadb.org
acl yum_update_dst dstdomain mirrorlist.centos.org
acl yum_update_dst dstdomain vault.centos.org
acl yum_update_dst dstdomain ftp.twaren.net
acl yum_update_dst dstdomain ftp.tc.edu.tw
acl yum_update_dst dstdomain ftp.yzu.edu.tw
acl yum_update_dst dstdomain ftp.stu.edu.tw
acl yum_update_dst dstdomain .github.com
acl yum_update_dst dstdomain .iuscommunity.org
acl yum_update_dst dstdomain .debian.org
acl yum_update_dst dstdomain .webtatic.com
acl yum_update_dst dstdomain .proxmox.com
http_access allow yum_update_src yum_update_dst

########################################k##


http_access deny all

# Squid normally listens to port 3128
http_port 3128

# We recommend you to use at least the following line.
#hierarchy_stoplist cgi-bin ?

# Uncomment and adjust the following to add a disk cache directory.
#cache_dir ufs /var/spool/squid 100 16 256
#cache_dir ufs /cache1 1000 16 256
#cache_dir ufs /cache2 1000 16 256
#cache_dir ufs /cache3 1000 16 256
http_access allow localhost
http_access deny all
#######################################

http_reply_access allow all
icp_access allow all
cache_effective_group proxy
coredump_dir /var/spool/squid
refresh_pattern ^ftp:		1440	20%	10080
refresh_pattern ^gopher:	1440	0%	1440
refresh_pattern .		0	20%	4320
